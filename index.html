<!DOCTYPE html>
<html>
<head>
  <title>ReelShorts Carousel with Paywall</title>
  <style>
    body { margin:0; background:black; overflow-x:hidden; font-family: Arial; }
    #carousel { display:flex; overflow-x:auto; scroll-snap-type:x mandatory; height:100vh; }

    .episode-container {
      min-width:100%;
      height:100vh;
      scroll-snap-align:start;
      position:relative;
      display:flex;
      justify-content:center;
      align-items:center;
      background:black;
    }

    /* Loading overlay */
    .loading-overlay {
      position:absolute;
      top:0;
      left:0;
      width:100%;
      height:100%;
      display:none; /* hidden initially */
      flex-direction: column;
      justify-content:center;
      align-items:center;
      background: rgba(0,0,0,0.8);
      color:white;
      font-size:24px;
      z-index:2;
      pointer-events:none; /* does not block clicks */
    }
    .spinner {
      border: 6px solid rgba(255,255,255,0.3);
      border-top: 6px solid white;
      border-radius: 50%;
      width:50px;
      height:50px;
      animation: spin 1s linear infinite;
      margin-bottom:10px;
    }

    /* Locked overlay */
    .locked-overlay {
      position:absolute;
      top:0;
      left:0;
      width:100%;
      height:100%;
      background: rgba(0,0,0,0.85);
      color:white;
      display:flex;
      flex-direction: column;
      justify-content:center;
      align-items:center;
      font-size:24px;
      z-index:4;
    }
    .locked-overlay button {
      font-size:20px;
      padding:10px 20px;
      margin-top:10px;
      cursor:pointer;
    }

    /* Arrows */
    .arrow {
      position:absolute;
      top:50%;
      font-size:48px;
      color:white;
      background: rgba(0,0,0,0.3);
      padding:10px;
      cursor:pointer;
      z-index:5;
      user-select:none;
    }
    #arrow-left { left:10px; transform:translateY(-50%); }
    #arrow-right { right:10px; transform:translateY(-50%); }
  </style>
</head>
<body>

<div id="carousel">
  <!-- Episode 1 -->
  <div class="episode-container">
    <div id="player-0"></div>
    <div class="loading-overlay" id="loading-0">
      <div class="spinner"></div>
      Loading...
    </div>
    <div class="locked-overlay" id="locked-0">
      <p>Locked episode</p>
      <a href="https://www.paypal.com/pay?your_button_id" target="_blank">
        <button>Pay to Unlock</button>
      </a>
    </div>
  </div>
  <!-- Episode 2 -->
  <div class="episode-container">
    <div id="player-1"></div>
    <div class="loading-overlay" id="loading-1">
      <div class="spinner"></div>
      Loading...
    </div>
    <div class="locked-overlay" id="locked-1">
      <p>Locked episode</p>
      <a href="https://www.paypal.com/pay?your_button_id" target="_blank">
        <button>Pay to Unlock</button>
      </a>
    </div>
  </div>
  <!-- Episode 3 -->
  <div class="episode-container">
    <div id="player-2"></div>
    <div class="loading-overlay" id="loading-2">
      <div class="spinner"></div>
      Loading...
    </div>
    <div class="locked-overlay" id="locked-2">
      <p>Locked episode</p>
      <a href="https://www.paypal.com/pay?your_button_id" target="_blank">
        <button>Pay to Unlock</button>
      </a>
    </div>
  </div>
  <!-- Add more episodes 4+ as needed -->
</div>

<div id="arrow-left" class="arrow">&#10094;</div>
<div id="arrow-right" class="arrow">&#10095;</div>

<script src="https://www.youtube.com/iframe_api"></script>
<script>
const videoIds = [
  'CuK_NZ01u-I', // Episode 1
  'aKk1p0EiWXs', // Episode 2
  'Q8rHDvj4asE'  // Episode 3
];

const freeEpisodes = 3; // Episodes 0,1,2 are free
const players = [];
const loadingOverlays = [];
const totalEpisodes = videoIds.length;
let currentIndex = 0;

function onYouTubeIframeAPIReady() {
  videoIds.forEach((vid, index) => {
    const overlay = document.getElementById(`loading-${index}`);
    const lockedOverlay = document.getElementById(`locked-${index}`);
    loadingOverlays[index] = overlay;

    // Hide locked overlay for free episodes
    if(index < freeEpisodes){
      lockedOverlay.style.display = 'none';
    } else {
      lockedOverlay.style.display = 'flex';
    }

    players[index] = new YT.Player(`player-${index}`, {
      height: '100%',
      width: '100%',
      videoId: vid,
      playerVars: { rel:0, modestbranding:1 },
      events: {
        onReady: function(event) {
          // Show loading overlay only when user clicks the iframe
          event.target.getIframe().addEventListener('click', () => {
            // Only show if not locked
            if(index >= freeEpisodes && lockedOverlay.style.display !== 'none') return;
            overlay.style.display = 'flex';
          });
        },
        onStateChange: function(event) {
          if (event.data === YT.PlayerState.PLAYING) {
            overlay.style.display = 'none';
          }
        }
      }
    });
  });
}

// Arrow navigation
const carousel = document.getElementById('carousel');
document.getElementById('arrow-left').onclick = () => {
  if(currentIndex > 0){
    currentIndex--;
    carousel.children[currentIndex].scrollIntoView({behavior:'smooth'});
  }
};
document.getElementById('arrow-right').onclick = () => {
  if(currentIndex < totalEpisodes-1){
    currentIndex++;
    carousel.children[currentIndex].scrollIntoView({behavior:'smooth'});
  }
};

// Optional: Simulate unlock for testing
document.querySelectorAll('.locked-overlay button').forEach(btn=>{
  btn.addEventListener('click', e=>{
    const overlay = e.target.parentElement;
    overlay.style.display = 'none'; // unlock the episode
  });
});
</script>

</body>
</html>
